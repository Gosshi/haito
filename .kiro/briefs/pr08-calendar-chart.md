# PR#8: 月別配当カレンダー + グラフ

## 参照ドキュメント
- docs/product.md「F5: 月別配当カレンダー」節
- docs/product.md「画面構成」節（/calendar）
- docs/product.md「データベーススキーマ」節（holdings, dividend_data テーブル）

## 目的
12ヶ月のカレンダー形式で配当入金予定を表示し、棒グラフで月別配当額を可視化する。ユーザーがいつ・どの銘柄から・いくら配当が入るかを把握できる。

## 範囲

### In scope
- `/calendar` ページのUI実装
- 12ヶ月カレンダー形式の配当表示
  - 各月に配当入金予定の銘柄名と金額を表示
  - payment_months（配当支払月）を基準に表示
  - 月ごとの合計金額
- 月別配当額の棒グラフ
  - X軸: 1月〜12月
  - Y軸: 配当金額（税引後）
  - ホバーで詳細表示
- 配当データの月別集計ロジック
  - 年2回配当の場合: 年間配当 ÷ 2 を各支払月に配分
  - 年4回配当の場合: 年間配当 ÷ 4 を各支払月に配分
- 口座種別による色分け（任意）
- レスポンシブ対応（PC優先）

### Out of scope
- 週別・日別カレンダー
- 過去の配当実績表示
- iCal / Googleカレンダー連携
- 配当通知機能

## 技術固定（変更禁止）
- グラフライブラリ: Recharts を使用
- UIコンポーネント: shadcn/ui の Card, Table を使用
- 配当支払月は dividend_data.payment_months を使用
- 税引後金額で表示（PR#7の計算ロジックを流用）

## 受け入れ条件（AC）
- [ ] `/calendar` に12ヶ月分のカレンダーが表示される
- [ ] 各月に配当入金予定の銘柄と金額が表示される
- [ ] 月ごとの配当合計金額が表示される
- [ ] 月別配当額の棒グラフが表示される
- [ ] グラフの各棒にホバーすると詳細（金額、銘柄内訳）が表示される
- [ ] 配当データがない月は ¥0 と表示される
- [ ] 保有銘柄がない場合、「銘柄を登録してください」メッセージが表示される
- [ ] PC画面で横幅を活かしたレイアウトになっている
- [ ] 金額は税引後で表示される（特定口座は20.315%控除後）

## 禁止事項
- Recharts 以外のグラフライブラリの導入
- DBスキーマの変更
- 週別・日別カレンダーの実装
- 外部API呼び出しの追加

## 成果物
1. **コード:**
   - `/app/calendar/page.tsx`
   - `/components/calendar/monthly-calendar.tsx`
   - `/components/calendar/dividend-bar-chart.tsx`
   - `/components/calendar/month-card.tsx`
   - `/lib/calculations/monthly-dividend.ts`（月別集計ロジック）
2. **PR要約:** カレンダー・グラフの説明、画面スクリーンショット

## 質問（最大3つ）
1. 配当支払月が不明（payment_months が空）の銘柄はどう表示するか？（「不明」として別枠表示 or 権利確定月+3ヶ月で推定）
2. グラフの色は口座種別ごとに分けるか？（特定=青、NISA=緑など）
3. カレンダーの年選択機能は必要か？（デフォルトは当年のみ表示）
