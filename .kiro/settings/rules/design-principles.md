# 設計原則（Design Principles）

本ドキュメントは、本プロジェクトにおける **設計上の不変ルール（憲法）** を定義する。
個別の spec / design.md よりも **優先度が高い**。

実装担当（Codex）は、本原則を前提として実装を行うこと。

---

## 1. 役割分担の原則（最重要）

- **設計（要件・仕様・構造の決定）** は上流（ClaudeCode）が担う
- **実装（コード・テスト・差分作成）** は Codex が担う
- 実装担当は、設計判断を変更・拡張してはいけない

---

## 2. フェーズ分離の原則

以下のフェーズは明確に分離する：

1. 要件定義（requirements）
2. 設計（design）
3. タスク分解（tasks）
4. 実装（code）

- 前フェーズが **人手レビューで確定** するまで、次フェーズへ進まない
- 実装フェーズでは、要件・設計に立ち戻って変更してはいけない

---

## 3. 最小スコープ原則（MVP優先）

- 各PRは **1〜2日で完了する粒度** に分割する
- 「あとで便利」「将来必要」は **今回やらない**
- Phase2 / Phase3 の要素は、明示的に Out of Scope とする

---

## 4. 変更禁止・提案分離の原則

- 設計変更が必要だと判断した場合：
  - 実装を止める
  - **「提案」として別枠で列挙** する
  - 勝手に実装に含めてはいけない

---

## 5. 一貫性優先の原則

- 既存コード・既存パターンを最優先で踏襲する
- 「より良い方法」があっても、既存と乖離するなら採用しない
- 一貫性 > 局所最適

---

## 6. 明示性の原則

- 暗黙の前提に依存しない
- 以下は必ず明文化する：
  - In Scope / Out of Scope
  - 受け入れ条件（AC）
  - 禁止事項
- 曖昧な点は最大3つまで質問し、それ以上は合理的に仮定する

---

## 7. 実装責務の原則

実装担当（Codex）の責務は以下に限定される：

- 設計どおりにコードを書く
- 必要十分なテストを追加する
- lint / typecheck / CI を通す
- PRに貼れる形で変更点を要約する

以下は責務外とする：

- UI/UXの再設計
- アーキテクチャ変更
- 技術選定の再検討

---

## 8. ドキュメントの位置づけ

- `docs/product.md`  
  → プロダクト要件・背景（変更頻度低）
- `requirements.md`  
  → PR/フェーズ単位の要件
- `design.md`  
  → 実装前に確定した設計判断
- `tasks.md`  
  → 実装タスクへの分解
- 本ファイル（design-principles.md）  
  → **全てに優先する設計原則**

---

## 9. 例外の扱い

- 本原則に反する対応が必要な場合：
  - その理由を明示する
  - 人手レビューで合意を取る
  - 暗黙に破ってはいけない

---

## 10. 最終原則（実装者向け）

> **実装者は「設計を完成させる存在」ではない。  
> 設計を「正確に実現する存在」である。**
