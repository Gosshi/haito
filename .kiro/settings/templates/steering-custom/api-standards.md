# API標準

[目的: 命名、構造、認証、バージョニング、エラーの一貫したAPIパターン]

## 哲学
- 予測可能でリソース指向の設計を優先する
- コントラクトを明示的に; 破壊的変更を最小化する
- デフォルトでセキュア（認証優先、最小権限）

## エンドポイントパターン
```
/{version}/{resource}[/{id}][/{sub-resource}]
```
例:
- `/api/v1/users`
- `/api/v1/users/:id`
- `/api/v1/users/:id/posts`

HTTPメソッド:
- GET（読み取り、安全、冪等）
- POST（作成）
- PUT/PATCH（更新）
- DELETE（削除、冪等）

## リクエスト/レスポンス

リクエスト（典型的）:
```json
{ "data": { ... }, "metadata": { "requestId": "..." } }
```

成功:
```json
{ "data": { ... }, "meta": { "timestamp": "...", "version": "..." } }
```

エラー:
```json
{ "error": { "code": "ERROR_CODE", "message": "...", "field": "optional" } }
```
（ルールについてはerror-handlingを参照。）

## ステータスコード（パターン）
- 2xx: 成功（200 読み取り、201 作成、204 削除）
- 4xx: クライアント問題（400 検証、401/403 認証、404 見つからない）
- 5xx: サーバー問題（500 汎用、503 利用不可）
結果を最もよく反映するステータスを選択する。

## 認証
- 認証情報は標準的な場所に
```
Authorization: Bearer {token}
```
- ビジネスロジックの前に未認証を拒否する

## バージョニング
- URL/ヘッダー/メディアタイプでバージョニング
- 破壊的変更 → 新しいバージョン
- 非破壊的変更 → 同じバージョン
- 廃止期間とコミュニケーションを提供する

## ページネーション/フィルタリング（該当する場合）
- ページネーション: `page`, `pageSize`またはカーソルベース
- フィルタリング: 明示的なクエリパラメータ
- ソート: `sort=field:asc|desc`
`meta`にページネーションメタデータを返す。

---
_パターンと決定に焦点を当て、エンドポイントカタログではない。_
