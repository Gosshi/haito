---
description: TDD手法を使用してspecタスクを実行する
allowed-tools: Bash, Read, Write, Edit, MultiEdit, Grep, Glob, LS, WebFetch, WebSearch
argument-hint: <feature-name> [task-numbers]
---

# 実装タスク実行

<background_information>
- **ミッション**: 承認された仕様に基づいてテスト駆動開発手法で実装タスクを実行する
- **成功基準**:
  - すべてのテストが実装コードの前に書かれている
  - コードがすべてのテストをパスし、リグレッションがない
  - tasks.mdでタスクが完了としてマークされている
  - 実装が設計と要件に整合している
</background_information>

<instructions>
## コアタスク
テスト駆動開発を使用して機能 **$1** の実装タスクを実行する。

## 実行ステップ

### ステップ1: コンテキストのロード

**必要なコンテキストをすべて読み込む**:
- `.kiro/specs/$1/spec.json`、`requirements.md`、`design.md`、`tasks.md`
- **完全なプロジェクトメモリのための`.kiro/steering/`ディレクトリ全体**

**承認の検証**:
- spec.jsonでタスクが承認されていることを確認（されていない場合は停止、セーフティ＆フォールバックを参照）

### ステップ2: タスクの選択

**実行するタスクを決定**:
- `$2`が提供された場合: 指定されたタスク番号を実行（例: "1.1"または"1,2,3"）
- それ以外: すべての保留中タスク（tasks.mdの未チェック`- [ ]`）を実行

### ステップ3: TDDで実行

選択された各タスクについて、Kent BeckのTDDサイクルに従う:

1. **RED - 失敗するテストを書く**:
   - 次の小さな機能のためのテストを書く
   - テストは失敗する（コードがまだ存在しない）
   - 説明的なテスト名を使用

2. **GREEN - 最小限のコードを書く**:
   - テストをパスさせる最もシンプルな解決策を実装
   - このテストをパスさせることにのみ集中
   - オーバーエンジニアリングを避ける

3. **REFACTOR - クリーンアップ**:
   - コード構造と可読性を改善
   - 重複を削除
   - 適切な場所にデザインパターンを適用
   - リファクタリング後もすべてのテストがパスすることを確認

4. **VERIFY - 品質の検証**:
   - すべてのテストがパス（新規と既存）
   - 既存機能にリグレッションがない
   - コードカバレッジが維持または改善

5. **MARK COMPLETE**:
   - tasks.mdでチェックボックスを`- [ ]`から`- [x]`に更新

## 重要な制約
- **TDD必須**: テストは実装コードの前に書かなければならない
- **タスクスコープ**: 特定のタスクが要求するもののみを実装
- **テストカバレッジ**: すべての新しいコードにテストが必要
- **リグレッションなし**: 既存のテストは引き続きパスする必要がある
- **設計整合性**: 実装はdesign.mdの仕様に従う必要がある
</instructions>

## ツールガイダンス
- **最初に読む**: 実装前にすべてのコンテキストをロード
- **テスト優先**: コードの前にテストを書く
- 必要に応じてライブラリドキュメントのために**WebSearch/WebFetch**を使用

## 出力説明

spec.jsonで指定された言語で簡潔なサマリーを提供:

1. **実行されたタスク**: タスク番号とテスト結果
2. **ステータス**: tasks.mdで完了マークされたタスク、残りのタスク数

**フォーマット**: 簡潔（150語以下）

## セーフティ＆フォールバック

### エラーシナリオ

**タスクが承認されていないまたはspecファイルがない**:
- **実行停止**: すべてのspecファイルが存在し、タスクが承認されている必要がある
- **推奨アクション**: 「前のフェーズを完了してください: `/kiro:spec-requirements`、`/kiro:spec-design`、`/kiro:spec-tasks`」

**テスト失敗**:
- **実装停止**: 続行する前に失敗するテストを修正
- **アクション**: デバッグして修正、その後再実行

### タスク実行

**特定のタスクを実行**:
- `/kiro:spec-impl $1 1.1` - 単一タスク
- `/kiro:spec-impl $1 1,2,3` - 複数タスク

**すべての保留中を実行**:
- `/kiro:spec-impl $1` - すべての未チェックタスク

think
